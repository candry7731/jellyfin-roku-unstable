"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var chai = require("chai");
var fs = require("fs-extra");
var chai_1 = require("chai");
var path = require("path");
var ProcessorConfig_1 = require("./ProcessorConfig");
var RooibosProcessor_1 = require("./RooibosProcessor");
var chaiSubset = require('chai-subset');
chai.use(chaiSubset);
var processor;
var sourcePath = 'src/test/stubProject';
var targetPath = 'build';
var config = ProcessorConfig_1.createProcessorConfig(require('../test/testProcessorConfig.json'));
function clearFiles() {
    fs.removeSync(targetPath);
}
function copyFiles() {
    try {
        fs.copySync(sourcePath, targetPath);
    }
    catch (err) {
        console.error(err);
    }
}
describe('RooibosProcessor tests', function () {
    beforeEach(function () {
        clearFiles();
        copyFiles();
        processor = new RooibosProcessor_1.RooibosProcessor(config);
    });
    describe('Initialization', function () {
        it('correctly sets source paths and config', function () {
            chai_1.expect(processor.config).to.equal(config);
        });
    });
    describe('Process files valid test', function () {
        it('processor runs ', function () {
            processor.processFiles();
        });
        it('tests creates map file', function () {
            processor.processFiles();
            var filePath = path.resolve(path.join(config.projectPath, config.outputPath, 'rooibosFunctionMap.brs'));
            chai_1.expect(fs.existsSync(filePath)).to.be.true;
        });
    });
});
